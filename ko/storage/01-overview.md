# ìŠ¤í† ë¦¬ì§€ ê°œìš”

{% hint style="info" %}
ğŸ’¡ bkend ìŠ¤í† ë¦¬ì§€ë¡œ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³ , ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”.
{% endhint %}

## ìŠ¤í† ë¦¬ì§€ë€?

ì•±ì—ì„œ í”„ë¡œí•„ ì‚¬ì§„, ê²Œì‹œê¸€ ì´ë¯¸ì§€, ë¬¸ì„œ íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ì—…ë¡œë“œí•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´ bkendì˜ íŒŒì¼ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. Presigned URL ë°©ì‹ìœ¼ë¡œ íŒŒì¼ì´ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ì§ì ‘ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ë©ë‹ˆë‹¤.

bkend ìŠ¤í† ë¦¬ì§€ëŠ” íŒŒì¼ ì—…ë¡œë“œ, ë‹¤ìš´ë¡œë“œ, ë©”íƒ€ë°ì´í„° ê´€ë¦¬ë¥¼ ìœ„í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. Presigned URLì€ ì¼ì • ì‹œê°„ ë™ì•ˆë§Œ ìœ íš¨í•œ ì„œëª…ëœ URLë¡œ, í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ì§ì ‘ ìŠ¤í† ë¦¬ì§€ì— íŒŒì¼ì„ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. Presigned URL ê¸°ë°˜ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©°, ë©”íƒ€ë°ì´í„° APIë¡œ íŒŒì¼ ì •ë³´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

```mermaid
sequenceDiagram
    participant C as í´ë¼ì´ì–¸íŠ¸
    participant B as bkend API
    participant S as ìŠ¤í† ë¦¬ì§€

    C->>B: Presigned URL ìš”ì²­
    B-->>C: ì—…ë¡œë“œ URL ë°˜í™˜
    C->>S: íŒŒì¼ ì§ì ‘ ì—…ë¡œë“œ
    C->>B: ë©”íƒ€ë°ì´í„° ë“±ë¡
    B-->>C: íŒŒì¼ ì •ë³´ ë°˜í™˜
```

***

## í•µì‹¬ íŠ¹ì§•

### Presigned URL ì—…ë¡œë“œ

íŒŒì¼ì€ bkend ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ìŠ¤í† ë¦¬ì§€ì— ì§ì ‘ ì—…ë¡œë“œë©ë‹ˆë‹¤. ì„œë²„ ë¶€í•˜ ì—†ì´ ëŒ€ìš©ëŸ‰ íŒŒì¼ë„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì™œ Presigned URLì¸ê°€?

bkendëŠ” íŒŒì¼ì„ API ì„œë²„ë¡œ ì§ì ‘ ì „ì†¡(Direct Upload)í•˜ì§€ ì•Šê³ , **3ë‹¨ê³„ Presigned URL íŒ¨í„´**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ë°©ì‹ì„ ì±„íƒí•œ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```mermaid
flowchart TD
    subgraph "âŒ ì§ì ‘ ì—…ë¡œë“œ (ë¹„íš¨ìœ¨)"
        A1[í´ë¼ì´ì–¸íŠ¸] -->|íŒŒì¼ ì „ì²´ ì „ì†¡| B1[API ì„œë²„]
        B1 -->|ë‹¤ì‹œ ì „ì†¡| C1[ìŠ¤í† ë¦¬ì§€]
    end

    subgraph "âœ… Presigned URL (bkend ë°©ì‹)"
        A2[í´ë¼ì´ì–¸íŠ¸] -->|URL ìš”ì²­ë§Œ| B2[API ì„œë²„]
        B2 -->|ì„œëª…ëœ URL ë°˜í™˜| A2
        A2 -->|íŒŒì¼ ì§ì ‘ ì—…ë¡œë“œ| C2[ìŠ¤í† ë¦¬ì§€]
    end
```

| ì´ì  | ì„¤ëª… |
|------|------|
| **ë³´ì•ˆ** | íŒŒì¼ì´ API ì„œë²„ë¥¼ í†µê³¼í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì„œë²„ ë©”ëª¨ë¦¬ì— íŒŒì¼ ë°ì´í„°ê°€ ë…¸ì¶œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Presigned URLì€ ì œí•œëœ ì‹œê°„ ë™ì•ˆë§Œ ìœ íš¨í•˜ì—¬ ë¬´ë‹¨ ì ‘ê·¼ì„ ë°©ì§€í•©ë‹ˆë‹¤. |
| **ì„±ëŠ¥** | í´ë¼ì´ì–¸íŠ¸ê°€ ìŠ¤í† ë¦¬ì§€ì— ì§ì ‘ ì—…ë¡œë“œí•˜ë¯€ë¡œ, API ì„œë²„ê°€ íŒŒì¼ ë°ì´í„°ë¥¼ ì¤‘ê³„í•˜ëŠ” ë³‘ëª©ì´ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì—…ë¡œë“œ ì†ë„ê°€ ì„œë²„ ëŒ€ì—­í­ì— ì œí•œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. |
| **í™•ì¥ì„±** | API ì„œë²„ëŠ” URL ë°œê¸‰ë§Œ ì²˜ë¦¬í•˜ë¯€ë¡œ, ìˆ˜ì²œ ëª…ì´ ë™ì‹œì— íŒŒì¼ì„ ì—…ë¡œë“œí•´ë„ ì„œë²„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ì´ ìµœì†Œí™”ë©ë‹ˆë‹¤. ëŒ€ìš©ëŸ‰ íŒŒì¼(ìˆ˜ GB)ë„ ì„œë²„ ë¶€í•˜ ì—†ì´ ì²˜ë¦¬ë©ë‹ˆë‹¤. |

{% hint style="info" %}
ğŸ’¡ Presigned URLì€ ë°œê¸‰ í›„ ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ë§Œë£Œë©ë‹ˆë‹¤. URL ë°œê¸‰ í›„ ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì—…ë¡œë“œë¥¼ ì‹œì‘í•˜ì„¸ìš”.
{% endhint %}

### ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ

ëŒ€ìš©ëŸ‰ íŒŒì¼ì€ ì—¬ëŸ¬ ì¡°ê°ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë³‘ë ¬ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—…ë¡œë“œ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ íŒŒíŠ¸ë§Œ ì¬ì‹œë„í•˜ë©´ ë©ë‹ˆë‹¤.

### ë©”íƒ€ë°ì´í„° ê´€ë¦¬

íŒŒì¼ì˜ ì´ë¦„, í¬ê¸°, MIME íƒ€ì…, ì¹´í…Œê³ ë¦¬, íƒœê·¸ ë“± ë©”íƒ€ë°ì´í„°ë¥¼ ë³„ë„ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì ‘ê·¼ ì œì–´

íŒŒì¼ë§ˆë‹¤ ì ‘ê·¼ ë²”ìœ„(`visibility`)ë¥¼ ì„¤ì •í•˜ì—¬ ê³µê°œ/ë¹„ê³µê°œë¥¼ ì œì–´í•©ë‹ˆë‹¤.

| Visibility | ì„¤ëª… |
|-----------|------|
| `public` | ëˆ„êµ¬ë‚˜ ì ‘ê·¼ ê°€ëŠ¥ |
| `private` | ì†Œìœ ìë§Œ ì ‘ê·¼ ê°€ëŠ¥ |
| `protected` | ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥ |
| `shared` | ì§€ì •ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥ |

### ì´ë¯¸ì§€ ìµœì í™” CDN

`public` ì´ë¯¸ì§€ëŠ” `img.bkend.ai` CDNì„ í†µí•´ URLë§Œìœ¼ë¡œ ë¦¬ì‚¬ì´ì¦ˆ, í¬ë§· ë³€í™˜, í’ˆì§ˆ ì¡°ì ˆì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë³„ë„ API í˜¸ì¶œ ì—†ì´ URL íŒ¨í„´ë§Œ êµ¬ì„±í•˜ë©´ ìµœì í™”ëœ ì´ë¯¸ì§€ê°€ ì œê³µë©ë‹ˆë‹¤.

```
https://img.bkend.ai/fit-in/300x200/filters:quality(80)/{filePath}
```

***

## íŒŒì¼ ì¹´í…Œê³ ë¦¬

| ì¹´í…Œê³ ë¦¬ | ì„¤ëª… |
|---------|------|
| `images` | ì´ë¯¸ì§€ íŒŒì¼ |
| `documents` | ë¬¸ì„œ íŒŒì¼ |
| `media` | ë¯¸ë””ì–´ (ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤) |
| `attachments` | ì²¨ë¶€ íŒŒì¼ |
| `exports` | ë‚´ë³´ë‚´ê¸° íŒŒì¼ |
| `backups` | ë°±ì—… íŒŒì¼ |
| `temp` | ì„ì‹œ íŒŒì¼ |

***

## ì—…ë¡œë“œ íë¦„

### ë‹¨ì¼ íŒŒì¼ ì—…ë¡œë“œ

```mermaid
flowchart LR
    A[Presigned URL ìš”ì²­] --> B[íŒŒì¼ ì—…ë¡œë“œ]
    B --> C[ë©”íƒ€ë°ì´í„° ë“±ë¡]
    C --> D[ì™„ë£Œ]
```

1. `POST /v1/files/presigned-url` â€” ì—…ë¡œë“œ URL ë°œê¸‰
2. ìŠ¤í† ë¦¬ì§€ì— íŒŒì¼ ì§ì ‘ ì—…ë¡œë“œ (PUT)
3. `POST /v1/files` â€” ë©”íƒ€ë°ì´í„° ë“±ë¡

### ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ (ëŒ€ìš©ëŸ‰)

```mermaid
flowchart LR
    A[ì´ˆê¸°í™”] --> B[íŒŒíŠ¸ë³„ URL ë°œê¸‰]
    B --> C[íŒŒíŠ¸ ì—…ë¡œë“œ]
    C --> D[ì™„ë£Œ ìš”ì²­]
    D --> E[ë©”íƒ€ë°ì´í„° ë“±ë¡]
```

1. `POST /v1/files/multipart/init` â€” ì—…ë¡œë“œ ì´ˆê¸°í™”
2. `POST /v1/files/multipart/presigned-url` â€” íŒŒíŠ¸ë³„ URL ë°œê¸‰
3. ìŠ¤í† ë¦¬ì§€ì— ê° íŒŒíŠ¸ ì—…ë¡œë“œ (PUT)
4. `POST /v1/files/multipart/complete` â€” ì—…ë¡œë“œ ì™„ë£Œ
5. `POST /v1/files` â€” ë©”íƒ€ë°ì´í„° ë“±ë¡

***

## í•„ìˆ˜ í—¤ë”

| í—¤ë” | í•„ìˆ˜ | ì„¤ëª… |
|------|:----:|------|
| `X-API-Key` | âœ… | `{pk_publishable_key}` |
| `Authorization` | âœ… | `Bearer {accessToken}` |
| `Content-Type` | ì¡°ê±´ë¶€ | `application/json` â€” POST, PATCH ìš”ì²­ ì‹œ |

***

## ì´ ì„¹ì…˜ êµ¬ì„±

| ë¬¸ì„œ | ì„¤ëª… |
|------|------|
| [ë‹¨ì¼ íŒŒì¼ ì—…ë¡œë“œ](02-upload-single.md) | Presigned URLë¡œ íŒŒì¼ ì—…ë¡œë“œ |
| [ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ](03-upload-multipart.md) | ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ |
| [íŒŒì¼ ë©”íƒ€ë°ì´í„°](04-file-metadata.md) | ë©”íƒ€ë°ì´í„° ë“±ë¡/ì¡°íšŒ/ìˆ˜ì • |
| [íŒŒì¼ ëª©ë¡ ì¡°íšŒ](05-file-list.md) | í•„í„°ë§/ì •ë ¬/í˜ì´ì§€ë„¤ì´ì…˜ |
| [íŒŒì¼ ë‹¤ìš´ë¡œë“œ](06-download.md) | Presigned URLë¡œ ë‹¤ìš´ë¡œë“œ |
| [íŒŒì¼ ì‚­ì œ](07-file-delete.md) | íŒŒì¼ ì‚­ì œ |
| [íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ](08-permissions.md) | Visibilityì™€ ì†Œìœ ì ì œì–´ |
| [API ë ˆí¼ëŸ°ìŠ¤](09-api-reference.md) | ì „ì²´ ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡ |
| [íŒŒì¼ ì—…ë¡œë“œ ì•± íŒ¨í„´](10-upload-app-patterns.md) | ì•±ì—ì„œ íŒŒì¼ ì—…ë¡œë“œ êµ¬í˜„ |
| [ì´ë¯¸ì§€ ìµœì í™”](11-image-optimization.md) | URL ê¸°ë°˜ ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆ/í¬ë§· ë³€í™˜ |

{% hint style="info" %}
ğŸ’¡ **ì‹¤ì „ìœ¼ë¡œ ë°°ìš°ê¸°**: ì´ë¯¸ì§€ ì—…ë¡œë“œë¥¼ ì‹¤ì „ í”„ë¡œì íŠ¸ì—ì„œ í™œìš©í•˜ëŠ” ë°©ë²•ì€ [ì¿¡ë¶](../../cookbooks/README.md)ì„ ì°¸ê³ í•˜ì„¸ìš”.
{% endhint %}
