# ì„±ëŠ¥ ìµœì í™”

> bkend í”„ë¡œì íŠ¸ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ê°œìš”

bkendëŠ” ì¸ë±ìŠ¤ ê´€ë¦¬, ì¿¼ë¦¬ ìµœì í™”, íŒŒì¼ ì €ì¥ì†Œ ìµœì í™” ë“± ë‹¤ì–‘í•œ ì„±ëŠ¥ ê°œì„  ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## ì¸ë±ìŠ¤ ê´€ë¦¬

### ê¸°ë³¸ ì¸ë±ìŠ¤

bkendëŠ” í…Œì´ë¸” ìƒì„± ì‹œ ë‹¤ìŒ ì¸ë±ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

| ì¸ë±ìŠ¤ ì´ë¦„ | í•„ë“œ | ì •ë ¬ | ì„¤ëª… |
|-----------|------|------|------|
| `_id_` | `_id` | ì˜¤ë¦„ì°¨ìˆœ | ê¸°ë³¸ í‚¤ ì¸ë±ìŠ¤ (ì‹œìŠ¤í…œ) |
| `idx_createdAt_desc` | `createdAt` | ë‚´ë¦¼ì°¨ìˆœ | ìƒì„±ì¼ ì •ë ¬ |
| `idx_updatedAt_desc` | `updatedAt` | ë‚´ë¦¼ì°¨ìˆœ | ìˆ˜ì •ì¼ ì •ë ¬ |
| `idx_createdBy` | `createdBy` | ì˜¤ë¦„ì°¨ìˆœ | ì‘ì„±ì í•„í„°ë§ |

> âš ï¸ **ì£¼ì˜** - ê¸°ë³¸ ì¸ë±ìŠ¤ì™€ ì‹œìŠ¤í…œ ì¸ë±ìŠ¤(`_id_`)ëŠ” ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### ì»¤ìŠ¤í…€ ì¸ë±ìŠ¤ ì¶”ê°€í•˜ê¸°

ìì£¼ ì¡°íšŒí•˜ëŠ” í•„ë“œì— ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ ì¿¼ë¦¬ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.

```json
{
  "name": "idx_status_createdAt",
  "fields": {
    "status": 1,
    "createdAt": -1
  }
}
```

### ì¸ë±ìŠ¤ ìœ í˜•

| ìœ í˜• | ì„¤ëª… | ì‚¬ìš© ì˜ˆì‹œ |
|------|------|----------|
| **ë‹¨ì¼ í•„ë“œ** | í•˜ë‚˜ì˜ í•„ë“œì— ëŒ€í•œ ì¸ë±ìŠ¤ | `{ "email": 1 }` |
| **ë³µí•© ì¸ë±ìŠ¤** | ì—¬ëŸ¬ í•„ë“œë¥¼ ì¡°í•©í•œ ì¸ë±ìŠ¤ | `{ "status": 1, "createdAt": -1 }` |
| **Unique** | ì¤‘ë³µ ê°’ ë°©ì§€ | ì´ë©”ì¼, ìŠ¬ëŸ¬ê·¸ ë“± |
| **Sparse** | null ê°’ì„ ì œì™¸í•œ ì¸ë±ìŠ¤ | ì„ íƒì  í•„ë“œ |

### ì¸ë±ìŠ¤ ë²„ì „ ê´€ë¦¬

bkendëŠ” ì¸ë±ìŠ¤ ë³€ê²½ ì´ë ¥ì„ ë²„ì „ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤. ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```mermaid
flowchart LR
    A[v1: ê¸°ë³¸ ì¸ë±ìŠ¤] --> B[v2: email ì¸ë±ìŠ¤ ì¶”ê°€]
    B --> C[v3: ë³µí•© ì¸ë±ìŠ¤ ì¶”ê°€]
    C --> D[ë¬¸ì œ ë°œìƒ!]
    D --> E[v2ë¡œ ë¡¤ë°±]
```

---

## ì¿¼ë¦¬ ìµœì í™”

### í•„í„°ë§ ìµœì í™”

ì¸ë±ìŠ¤ê°€ ìˆëŠ” í•„ë“œë¥¼ ìš°ì„ ì ìœ¼ë¡œ í•„í„° ì¡°ê±´ì— ì‚¬ìš©í•˜ì„¸ìš”.

```typescript
// ì¢‹ì€ ì˜ˆ â€” ì¸ë±ìŠ¤ëœ í•„ë“œë¡œ í•„í„°ë§
const response = await fetch('/data/posts?status=published&sort=-createdAt&limit=20', {
  headers: { 'X-API-Key': '{your_api_key}' }
});

// ë‚˜ìœ ì˜ˆ â€” ì¸ë±ìŠ¤ ì—†ëŠ” í•„ë“œë¡œ í•„í„°ë§
const response = await fetch('/data/posts?content[$contains]=keyword', {
  headers: { 'X-API-Key': '{your_api_key}' }
});
```

### í˜ì´ì§€ë„¤ì´ì…˜ í™œìš©

ëŒ€ëŸ‰ ë°ì´í„°ë¥¼ ì¡°íšŒí•  ë•ŒëŠ” ë°˜ë“œì‹œ `limit`ê³¼ `offset`ì„ ì‚¬ìš©í•˜ì„¸ìš”.

| íŒŒë¼ë¯¸í„° | ì„¤ëª… | ê¶Œì¥ê°’ |
|---------|------|-------|
| `limit` | í•œ ë²ˆì— ì¡°íšŒí•  ë ˆì½”ë“œ ìˆ˜ | 10~50 |
| `offset` | ê±´ë„ˆë›¸ ë ˆì½”ë“œ ìˆ˜ | í˜ì´ì§€ Ã— limit |

```typescript
// í˜ì´ì§€ë„¤ì´ì…˜ ì˜ˆì‹œ
const page = 1;
const limit = 20;
const offset = (page - 1) * limit;

const response = await fetch(`/data/posts?limit=${limit}&offset=${offset}`, {
  headers: { 'X-API-Key': '{your_api_key}' }
});
```

### í•„ë“œ ì„ íƒ

í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒí•˜ì—¬ ì‘ë‹µ í¬ê¸°ë¥¼ ì¤„ì´ì„¸ìš”.

```typescript
// í•„ìš”í•œ í•„ë“œë§Œ ì¡°íšŒ
const response = await fetch('/data/posts?fields=title,status,createdAt', {
  headers: { 'X-API-Key': '{your_api_key}' }
});
```

---

## íŒŒì¼ ì €ì¥ì†Œ ìµœì í™”

### íŒŒì¼ í¬ê¸° ìµœì í™”

| íŒŒì¼ ìœ í˜• | ê¶Œì¥ì‚¬í•­ |
|----------|---------|
| **ì´ë¯¸ì§€** | ì—…ë¡œë“œ ì „ ì••ì¶•, WebP í˜•ì‹ ì‚¬ìš© |
| **ë¬¸ì„œ** | í•„ìš”í•œ í˜•ì‹ë§Œ ì €ì¥, PDF ì••ì¶• |
| **ëŒ€ìš©ëŸ‰ íŒŒì¼** | ë©€í‹°íŒŒíŠ¸ ì—…ë¡œë“œ í™œìš© |

### CDN í™œìš©

public íŒŒì¼ì€ CDNì„ í†µí•´ ì œê³µë˜ì–´ ì‘ë‹µ ì‹œê°„ì´ ë¹ ë¦…ë‹ˆë‹¤.

| ì ‘ê·¼ ë°©ì‹ | ì‘ë‹µ ì‹œê°„ | ë§Œë£Œ |
|----------|---------|------|
| **CDN** (public) | ë¹ ë¦„ | ë§Œë£Œ ì—†ìŒ |
| **Presigned URL** (private) | ë³´í†µ | 1ì‹œê°„ |

> ğŸ’¡ **Tip** - ìì£¼ ì ‘ê·¼í•˜ëŠ” íŒŒì¼ì€ `public`ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ CDNì˜ ì´ì ì„ í™œìš©í•˜ì„¸ìš”. ë¯¼ê°í•˜ì§€ ì•Šì€ ì´ë¯¸ì§€, CSS, JavaScript íŒŒì¼ì— ì í•©í•©ë‹ˆë‹¤.

---

## API í˜¸ì¶œ ìµœì í™”

### ë°°ì¹˜ ì²˜ë¦¬

ì—¬ëŸ¬ ë ˆì½”ë“œë¥¼ í•œ ë²ˆì— ì²˜ë¦¬í•˜ë©´ API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
// ë‚˜ìœ ì˜ˆ â€” ê°œë³„ ì‚½ì… (Në²ˆ í˜¸ì¶œ)
for (const item of items) {
  await fetch('/data/posts', {
    method: 'POST',
    body: JSON.stringify(item)
  });
}

// ì¢‹ì€ ì˜ˆ â€” ë°°ì¹˜ ì‚½ì… (1ë²ˆ í˜¸ì¶œ)
await fetch('/data/posts', {
  method: 'POST',
  body: JSON.stringify(items) // ë°°ì—´ë¡œ ì „ë‹¬
});
```

### í´ë¼ì´ì–¸íŠ¸ ìºì‹±

ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìºì‹±í•˜ì„¸ìš”.

```typescript
// ê°„ë‹¨í•œ ë©”ëª¨ë¦¬ ìºì‹œ ì˜ˆì‹œ
const cache = new Map<string, { data: unknown; expiry: number }>();

async function fetchWithCache(url: string, ttl = 60000) {
  const cached = cache.get(url);
  if (cached && cached.expiry > Date.now()) {
    return cached.data;
  }

  const response = await fetch(url, {
    headers: { 'X-API-Key': '{your_api_key}' }
  });
  const data = await response.json();
  cache.set(url, { data, expiry: Date.now() + ttl });
  return data;
}
```

---

## ì„±ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ìì£¼ í•„í„°ë§í•˜ëŠ” í•„ë“œì— ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í–ˆëŠ”ì§€ í™•ì¸
- [ ] í˜ì´ì§€ë„¤ì´ì…˜ì„ ì ìš©í–ˆëŠ”ì§€ í™•ì¸
- [ ] ë¶ˆí•„ìš”í•œ í•„ë“œë¥¼ ì œì™¸í•˜ê³  ì¡°íšŒí•˜ëŠ”ì§€ í™•ì¸
- [ ] public íŒŒì¼ì— CDNì„ í™œìš©í•˜ëŠ”ì§€ í™•ì¸
- [ ] ë°°ì¹˜ ì²˜ë¦¬ë¡œ API í˜¸ì¶œì„ ìµœì†Œí™”í–ˆëŠ”ì§€ í™•ì¸
- [ ] í´ë¼ì´ì–¸íŠ¸ ìºì‹±ì„ ì ìš©í–ˆëŠ”ì§€ í™•ì¸

---

## ê´€ë ¨ ë¬¸ì„œ

- [ì¸ë±ìŠ¤ & ì„±ëŠ¥](../database/14-indexes.md) â€” ì¸ë±ìŠ¤ ê´€ë¦¬ ìƒì„¸
- [í•„í„°ë§ & ê²€ìƒ‰](../database/10-filtering.md) â€” íš¨ìœ¨ì ì¸ ì¿¼ë¦¬ ì‘ì„±
- [ì •ë ¬ & í˜ì´ì§€ë„¤ì´ì…˜](../database/11-sorting-pagination.md) â€” í˜ì´ì§€ë„¤ì´ì…˜ í™œìš©
- [ì‚¬ìš©ëŸ‰ ë¶„ì„](../platform/06-usage-analytics.md) â€” API ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
